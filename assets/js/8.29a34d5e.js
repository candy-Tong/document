(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{173:function(t,e,_){"use strict";_.r(e);var s=_(0),r=Object(s.a)({},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._m(4),t._v(" "),t._m(5),t._v(" "),_("p",[t._v("如：")]),t._v(" "),t._m(6),t._m(7),t._v(" "),_("p",[t._v("自动记录请求的出入信息，包括以下：")]),t._v(" "),t._m(8),t._v(" "),_("p",[t._v("该功能由 "),_("router-link",{attrs:{to:"/框架原理/中间件.html#request"}},[t._v("request")]),t._v(" 和 "),_("router-link",{attrs:{to:"/框架原理/中间件.html#response"}},[t._v("response")]),t._v("中间件实现")],1),t._v(" "),t._m(9),t._v(" "),_("p",[t._v("在生产环境中，请求是具有并发性的，即同一时间，会有多个请求同时到达后台，不能保证日志文件的内容都是按请求顺序写入的。于是需要一个唯一的请求ID，以区分日志文件中不同的请求所输出的日志")]),t._v(" "),_("p",[t._v("在框架中，会自动给每个请求生成一个随机的id")]),t._v(" "),_("p",[t._v("当请求发生错误，可以先定位出错误请求，然后过滤出发生错误的请求，再进行错误排查")]),t._v(" "),_("p",[t._v("该功能由"),_("router-link",{attrs:{to:"/框架原理/中间件.html#uuid"}},[t._v("uuid")]),t._v("中间件实现")],1),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),_("p",[t._v("注意：经过的中间件链路不会打印日志，需要手动写日志")]),t._v(" "),_("p",[t._v("具体实现见"),_("router-link",{attrs:{to:"/框架原理/其他.html#封装控制器和服务"}},[t._v("框架原理")])],1)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#日志","aria-hidden":"true"}},[this._v("#")]),this._v(" 日志")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("该框架对"),e("code",[this._v("egg")]),this._v("日志进行了封装")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"日志格式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#日志格式","aria-hidden":"true"}},[this._v("#")]),this._v(" 日志格式")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("LOG_TIME LOG_TYPE PID [ACCOUNT/IP/REQ_ID/METHOD/USE_TIME/URL] CONTENT \n")])])])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ul",[_("li",[_("p",[_("code",[t._v("REACH_TIME")]),t._v("日志打印时间")])]),t._v(" "),_("li",[_("p",[_("code",[t._v("LOG_TYPE")]),t._v(" 日志类型，日志分为 "),_("code",[t._v("NONE")]),t._v("，"),_("code",[t._v("DEBUG")]),t._v("，"),_("code",[t._v("INFO")]),t._v("，"),_("code",[t._v("WARN")]),t._v(" 和 "),_("code",[t._v("ERROR")]),t._v(" 5 个级别，默认只会输出 "),_("code",[t._v("INFO")]),t._v(" 及以上（"),_("code",[t._v("WARN")]),t._v(" 和 "),_("code",[t._v("ERROR")]),t._v("）的日志到文件中")])]),t._v(" "),_("li",[_("p",[_("code",[t._v("PID")]),t._v(" 进程的pid，框架为多进程启动，可以查看输出日志的进程，一般情况下比较少用")])]),t._v(" "),_("li",[_("p",[_("code",[t._v("ACCOUNT")]),t._v(" 用户校园账号，只有需要校验登录态的请求，该项才会有值")])]),t._v(" "),_("li",[_("p",[_("code",[t._v("IP")]),t._v(" 客户端ip地址")])]),t._v(" "),_("li",[_("p",[_("code",[t._v("REQ_ID")]),t._v(" 请求的唯一id")])]),t._v(" "),_("li",[_("p",[_("code",[t._v("METHOD")]),t._v(" 请求方法")])]),t._v(" "),_("li",[_("p",[_("code",[t._v("USE_TIME")]),t._v(" 直到日志打印的时刻，请求所花费的时间")])]),t._v(" "),_("li",[_("p",[_("code",[t._v("URL")]),t._v(" 请求的url")])]),t._v(" "),_("li",[_("p",[_("code",[t._v("CONTENT")]),t._v(" 日志内容")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("如果其中一项为空，为显示为 "),e("code",[this._v("-")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("2019-02-24 15:29:30,029 INFO 12492 [15cthuang/127.0.0.1/7622e162-8331-4bb5-82c3-dd11d3015eda/272ms GET /user/mini_pro_login] content\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"出入记录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#出入记录","aria-hidden":"true"}},[this._v("#")]),this._v(" 出入记录")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("请求的参数")]),this._v(" "),e("li",[this._v("响应内容和响应时间")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"请求id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#请求id","aria-hidden":"true"}},[this._v("#")]),this._v(" 请求ID")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"方法记录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#方法记录","aria-hidden":"true"}},[this._v("#")]),this._v(" 方法记录")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("当"),e("code",[this._v("Controller")]),this._v("、"),e("code",[this._v("Service")]),this._v("的方法被调用时，能够自动打印出如下格式的日志：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("Call Controller: OauthController -> stuLogin\nCall Service: OauthService -> _updateStuToken\n")])])])}],!1,null,null,null);e.default=r.exports}}]);